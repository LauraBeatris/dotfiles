var h=Object.defineProperty;var T=Object.getOwnPropertyDescriptor;var v=Object.getOwnPropertyNames;var x=Object.prototype.hasOwnProperty;var B=n=>h(n,"__esModule",{value:!0});var D=(n,o)=>{for(var a in o)h(n,a,{get:o[a],enumerable:!0})},E=(n,o,a,c)=>{if(o&&typeof o=="object"||typeof o=="function")for(let i of v(o))!x.call(n,i)&&(a||i!=="default")&&h(n,i,{get:()=>o[i],enumerable:!(c=T(o,i))||c.enumerable});return n};var F=(n=>(o,a)=>n&&n.get(o)||(a=E(B({}),o,1),n&&n.set(o,a),a))(typeof WeakMap!="undefined"?new WeakMap:0);var R={};D(R,{default:()=>m});var t=require("@raycast/api"),f=require("child_process"),l=require("react");function m(){let[n,o]=(0,l.useState)([]),[a,c]=(0,l.useState)(void 0),i=t.preferences.shouldSearchInPaths?.value??!1,P=t.preferences.shouldPrioritizeAppsWhenFiltering?.value??!1,y=t.preferences.shouldShowPID?.value??!1,b=t.preferences.shouldShowPath?.value??!1,d=()=>{(0,f.exec)("ps -eo pid,pcpu,comm | sort -nrk 2,3",(e,r)=>{if(e!=null)return;let s=r.split(`
`).map(u=>{let[,I,A,p]=u.match(/(\d+)\s+(\d+[.|,]\d+)\s+(.*)/)??["","","",""],$=p.match(/[^/]*[^/]*$/i)?.[0]??"",k=p.includes(".prefPane"),L=p.includes(".app");return{id:I,cpu:A,path:p,name:$,type:k?"prefPane":L?"app":"binary"}}).filter(u=>u.name!=="");o(s)})};(0,l.useEffect)(()=>{d()},[]);let g=e=>e.type==="prefPane"?{fileIcon:e.path?.replace(/(.+\.prefPane)(.+)/,"$1")??""}:e.type==="app"?{fileIcon:e.path?.replace(/(.+\.app)(.+)/,"$1")??""}:"/System/Library/CoreServices/CoreTypes.bundle/Contents/Resources/ExecutableBinaryIcon.icns",C=e=>{(0,f.exec)(`kill -9 ${e.id}`),o(n.filter(r=>r.id!==e.id)),(0,t.clearSearchBar)({forceScrollToTop:!0}),(0,t.showHUD)(`\u2705 Killed ${e.name==="-"?`process ${e.id}`:e.name}`)},S=e=>e.path==null?null:_jsx(t.CopyToClipboardAction,{title:"Copy Path",content:e.path}),w=e=>{let r;return y&&(r=e.id),b&&(r=r?`${r} - ${e.path}`:e.path),r};return _jsx(t.List,{isLoading:n.length===0,searchBarPlaceholder:"Filter by name...",onSearchTextChange:e=>c(e)},n.filter(e=>{if(a==null)return!0;let r=e.name.toLowerCase().includes(a.toLowerCase()),s=e.path?.toLowerCase().match(new RegExp(`.+${a}.*\\.[app|framework|prefpane]`,"ig"))!=null;return r||i&&s}).sort((e,r)=>{if(a!=null&&P){if(e.type==="app"&&r.type!=="app")return-1;if(e.type!=="app"&&r.type==="app")return 1}return 0}).map((e,r)=>{let s=g(e);return _jsx(t.List.Item,{key:r,title:e.name,subtitle:w(e),icon:s,accessoryTitle:`${e.cpu}%`,actions:_jsx(t.ActionPanel,null,_jsx(t.ActionPanel.Item,{title:"Kill",icon:t.Icon.XmarkCircle,onAction:()=>C(e)}),S(e),_jsx(t.ActionPanel.Item,{title:"Reload",icon:t.Icon.ArrowClockwise,shortcut:{key:"r",modifiers:["cmd"]},onAction:()=>d()}))})}))}module.exports=F(R);0&&(module.exports={});
